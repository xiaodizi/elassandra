<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="zh">
<head>
<!-- Generated by javadoc (12.0.2) on Wed Mar 15 09:01:08 CST 2023 -->
<title>LambdaBootstrap (lang-painless 6.8.4.5-SNAPSHOT API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<meta name="dc.created" content="2023-03-15">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../../../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="LambdaBootstrap (lang-painless 6.8.4.5-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":9,"i1":9};
var tabs = {65535:["t0","\u6240\u6709\u65B9\u6CD5"],1:["t1","\u9759\u6001\u65B9\u6CD5"],8:["t4","\u5177\u4F53\u65B9\u6CD5"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>您的浏览器已禁用 JavaScript。</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="跳过导航链接">跳过导航链接</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../../../index.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../deprecated-list.html">已过时</a></li>
<li><a href="../../../index-all.html">索引</a></li>
<li><a href="../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li>嵌套&nbsp;|&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">构造器</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">构造器</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">方法</a></li>
</ul>
</div>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">程序包</span>&nbsp;<a href="package-summary.html">org.elasticsearch.painless</a></div>
<h2 title="类 LambdaBootstrap" class="title">类 LambdaBootstrap</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.elasticsearch.painless.LambdaBootstrap</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<pre>public final class <span class="typeNameLabel">LambdaBootstrap</span>
extends java.lang.Object</pre>
<div class="block">LambdaBootstrap is used to generate all the code necessary to execute
 lambda functions and method references within Painless.  The code generation
 used here is based upon the following article:
 http://cr.openjdk.java.net/~briangoetz/lambda/lambda-translation.html
 However, it is a simplified version as Painless has no concept of generics
 or serialization.  LambdaBootstrap is being used as a replacement for
 <code>LambdaMetafactory</code> since the Painless casting model
 cannot be fully supported through this class.

 For each lambda function/method reference used within a Painless script
 a class will be generated at link-time using the
 <a href="#lambdaBootstrap(java.lang.invoke.MethodHandles.Lookup,java.lang.String,java.lang.invoke.MethodType,java.lang.invoke.MethodType,java.lang.String,int,java.lang.String,java.lang.invoke.MethodType,int)"><code>lambdaBootstrap(java.lang.invoke.MethodHandles.Lookup, java.lang.String, java.lang.invoke.MethodType, java.lang.invoke.MethodType, java.lang.String, int, java.lang.String, java.lang.invoke.MethodType, int)</code></a> method that contains the following:
 1. member fields for any captured variables
 2. a constructor that will take in captured variables and assign them to
 their respective member fields
 3. a static ctor delegation method, if the lambda function is a ctor.
 4. a method that will load the member fields representing captured variables
 and take in any other necessary values based on the arguments passed into the
 lambda function/reference method; it will then make a delegated call to the
 actual lambda function/reference method

 Take for example the following Painless script:

 <code>
 List list1 = new ArrayList(); "
 list1.add(2); "
 List list2 = new ArrayList(); "
 list1.forEach(x -&gt; list2.add(x));"
 return list[0]"
 </code>

 The script contains a lambda function with a captured variable.
 The following Lambda class would be generated:

 <code>
     public static final class $$Lambda0 implements Consumer {
         private List arg$0;

         private $$Lambda0(List arg$0) {
             this.arg$0 = arg$0;
         }

         public static Consumer create$lambda(List arg$0) {
             return new $$Lambda0(arg$0);
         }

         public void accept(Object val$0) {
             Painless$Script.lambda$0(this.arg$0, val$0);
         }
     }

     public class Painless$Script implements ... {
         ...
         public static lambda$0(List list2, Object x) {
             list2.add(x);
         }
         ...
     }
 </code>

 Also the accept method actually uses an invokedynamic
 instruction to call the lambda$0 method so that
 <code>MethodHandle.asType(java.lang.invoke.MethodType)</code> can be used to do the necessary
 conversions between argument types without having to hard
 code them. For method references to a constructor, a static
 wrapper method is created, that creates a class instance and
 calls the constructor. This method is used by the
 invokedynamic call to initialize the instance.

 When the <code>CallSite</code> is linked the linked method depends
 on whether or not there are captures.  If there are no captures
 the same instance of the generated lambda class will be
 returned each time by the factory method as there are no
 changing values other than the arguments, the lambda is a singleton.
 If there are captures, a new instance of the generated lambda class
 will be returned each time with the captures passed into the
 factory method to be stored in the member fields.
 Instead of calling the ctor, a static factory method is created
 in the lambda class, because a method handle to the ctor directly
 is (currently) preventing Hotspot optimizer from correctly doing
 escape analysis. Escape analysis is important to optimize the
 code in a way, that a new instance is not created on each lambda
 invocation with captures, stressing garbage collector (thanks
 to Rémi Forax for the explanation about this on Jaxcon 2017!).</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>构造器概要</h3>
<div class="memberSummary">
<table>
<caption><span>构造器</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">构造器</th>
<th class="colLast" scope="col">说明</th>
</tr>
<tbody>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E()">LambdaBootstrap</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>方法概要</h3>
<div class="memberSummary">
<div role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="memberSummary_tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="activeTableTab">所有方法</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t1" class="tableTab" onclick="show(1);">静态方法</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t4" class="tableTab" onclick="show(8);">具体方法</button></div>
<div id="memberSummary_tabpanel" role="tabpanel">
<table aria-labelledby="t0">
<tr>
<th class="colFirst" scope="col">修饰符和类型</th>
<th class="colSecond" scope="col">方法</th>
<th class="colLast" scope="col">说明</th>
</tr>
<tbody>
<tr class="altColor" id="i0">
<td class="colFirst"><code>static java.lang.invoke.CallSite</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#delegateBootstrap(java.lang.invoke.MethodHandles.Lookup,java.lang.String,java.lang.invoke.MethodType,java.lang.invoke.MethodHandle)">delegateBootstrap</a></span>&#8203;(java.lang.invoke.MethodHandles.Lookup&nbsp;lookup,
                 java.lang.String&nbsp;delegateMethodName,
                 java.lang.invoke.MethodType&nbsp;interfaceMethodType,
                 java.lang.invoke.MethodHandle&nbsp;delegateMethodHandle)</code></th>
<td class="colLast">
<div class="block">Links the delegate method to the returned <code>CallSite</code>.</div>
</td>
</tr>
<tr class="rowColor" id="i1">
<td class="colFirst"><code>static java.lang.invoke.CallSite</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#lambdaBootstrap(java.lang.invoke.MethodHandles.Lookup,java.lang.String,java.lang.invoke.MethodType,java.lang.invoke.MethodType,java.lang.String,int,java.lang.String,java.lang.invoke.MethodType,int)">lambdaBootstrap</a></span>&#8203;(java.lang.invoke.MethodHandles.Lookup&nbsp;lookup,
               java.lang.String&nbsp;interfaceMethodName,
               java.lang.invoke.MethodType&nbsp;factoryMethodType,
               java.lang.invoke.MethodType&nbsp;interfaceMethodType,
               java.lang.String&nbsp;delegateClassName,
               int&nbsp;delegateInvokeType,
               java.lang.String&nbsp;delegateMethodName,
               java.lang.invoke.MethodType&nbsp;delegateMethodType,
               int&nbsp;isDelegateInterface)</code></th>
<td class="colLast">
<div class="block">Generates a lambda class for a lambda function/method reference
 within a Painless script.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>从类继承的方法&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>构造器详细资料</h3>
<a id="&lt;init&gt;()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>LambdaBootstrap</h4>
<pre>public&nbsp;LambdaBootstrap()</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>方法详细资料</h3>
<a id="lambdaBootstrap(java.lang.invoke.MethodHandles.Lookup,java.lang.String,java.lang.invoke.MethodType,java.lang.invoke.MethodType,java.lang.String,int,java.lang.String,java.lang.invoke.MethodType,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lambdaBootstrap</h4>
<pre class="methodSignature">public static&nbsp;java.lang.invoke.CallSite&nbsp;lambdaBootstrap&#8203;(java.lang.invoke.MethodHandles.Lookup&nbsp;lookup,
                                                        java.lang.String&nbsp;interfaceMethodName,
                                                        java.lang.invoke.MethodType&nbsp;factoryMethodType,
                                                        java.lang.invoke.MethodType&nbsp;interfaceMethodType,
                                                        java.lang.String&nbsp;delegateClassName,
                                                        int&nbsp;delegateInvokeType,
                                                        java.lang.String&nbsp;delegateMethodName,
                                                        java.lang.invoke.MethodType&nbsp;delegateMethodType,
                                                        int&nbsp;isDelegateInterface)
                                                 throws java.lang.invoke.LambdaConversionException</pre>
<div class="block">Generates a lambda class for a lambda function/method reference
 within a Painless script.  Variables with the prefix interface are considered
 to represent values for code generated for the lambda class. Variables with
 the prefix delegate are considered to represent values for code generated
 within the Painless script.  The interface method delegates (calls) to the
 delegate method.</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>lookup</code> - Standard <code>MethodHandles.lookup()</code></dd>
<dd><code>interfaceMethodName</code> - Name of functional interface method that is called</dd>
<dd><code>factoryMethodType</code> - The type of method to be linked to this CallSite; note that
                          captured types are based on the parameters for this method</dd>
<dd><code>interfaceMethodType</code> - The type of method representing the functional interface method</dd>
<dd><code>delegateClassName</code> - The name of the class to delegate method call to</dd>
<dd><code>delegateInvokeType</code> - The type of method call to be made
                           (static, virtual, interface, or constructor)</dd>
<dd><code>delegateMethodName</code> - The name of the method to be called in the Painless script class</dd>
<dd><code>delegateMethodType</code> - The type of method call in the Painless script class without
                           the captured types</dd>
<dd><code>isDelegateInterface</code> - If the method to be called is owned by an interface where
                            if the value is '1' if the delegate is an interface and '0'
                            otherwise; note this is an int because the bootstrap method
                            cannot convert constants to boolean</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>A <code>CallSite</code> linked to a factory method for creating a lambda class
 that implements the expected functional interface</dd>
<dt><span class="throwsLabel">抛出:</span></dt>
<dd><code>java.lang.invoke.LambdaConversionException</code> - Thrown when an illegal type conversion occurs at link time</dd>
</dl>
</li>
</ul>
<a id="delegateBootstrap(java.lang.invoke.MethodHandles.Lookup,java.lang.String,java.lang.invoke.MethodType,java.lang.invoke.MethodHandle)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>delegateBootstrap</h4>
<pre class="methodSignature">public static&nbsp;java.lang.invoke.CallSite&nbsp;delegateBootstrap&#8203;(java.lang.invoke.MethodHandles.Lookup&nbsp;lookup,
                                                          java.lang.String&nbsp;delegateMethodName,
                                                          java.lang.invoke.MethodType&nbsp;interfaceMethodType,
                                                          java.lang.invoke.MethodHandle&nbsp;delegateMethodHandle)</pre>
<div class="block">Links the delegate method to the returned <code>CallSite</code>.  The linked
 delegate method will use converted types from the interface method.  Using
 invokedynamic to make the delegate method call allows
 <code>MethodHandle.asType(java.lang.invoke.MethodType)</code> to be used to do the type conversion instead
 of either a lot more code or requiring many <code>Class</code>es to be looked
 up at link-time.</div>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="跳过导航链接">跳过导航链接</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../../../index.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../deprecated-list.html">已过时</a></li>
<li><a href="../../../index-all.html">索引</a></li>
<li><a href="../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li>嵌套&nbsp;|&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">构造器</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">构造器</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">方法</a></li>
</ul>
</div>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
